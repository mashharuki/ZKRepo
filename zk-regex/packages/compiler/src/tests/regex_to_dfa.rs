use crate::js_caller::{JsCallerError, regex_to_dfa};

#[test]
fn test_regex_to_dfa_case_1() {
    let regex = "[a-z]+";
    let dfa = regex_to_dfa(regex).unwrap();
    assert_eq!(serde_json::to_string_pretty(&dfa).unwrap(), r#"[
  {
    "type": "",
    "edges": {
      "[\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1
    }
  },
  {
    "type": "accept",
    "edges": {
      "[\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1
    }
  }
]"#);
}

#[test]
fn test_regex_to_dfa_case_2() {
    let regex = "[a-z0-9]+";
    let dfa = regex_to_dfa(regex).unwrap();
    assert_eq!(serde_json::to_string_pretty(&dfa).unwrap(), r#"[
  {
    "type": "",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1
    }
  },
  {
    "type": "accept",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1
    }
  }
]"#);
}

#[test]
fn test_regex_to_dfa_case_3() {

    let regex = "[a-z0-9]+@[a-z0-9]+\r\n";
    let dfa = regex_to_dfa(regex).unwrap();
    assert_eq!(serde_json::to_string_pretty(&dfa).unwrap(), r#"[
  {
    "type": "",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1
    }
  },
  {
    "type": "",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 1,
      "[\"@\"]": 2
    }
  },
  {
    "type": "",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 3
    }
  },
  {
    "type": "",
    "edges": {
      "[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\",\"m\",\"n\",\"o\",\"p\",\"q\",\"r\",\"s\",\"t\",\"u\",\"v\",\"w\",\"x\",\"y\",\"z\"]": 3,
      "[\"\\r\"]": 4
    }
  },
  {
    "type": "",
    "edges": {
      "[\"\\n\"]": 5
    }
  },
  {
    "type": "accept",
    "edges": {}
  }
]"#);
}